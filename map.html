<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Interactive Map of Solar Recycling Sites</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<style>
  body { font-family: Arial, sans-serif; margin: 0; padding: 0; }
  header { text-align: center; margin-top: 20px; }
  header nav a { text-decoration: none; color: #0077cc; font-weight: 500; }
  #map {
    width: 100%;
    height: 550px;
    max-width: 1000px;
    margin: 40px auto;
    border-radius: 12px;
    border: 1px solid #ddd;
    box-shadow: 0 6px 20px rgba(0,0,0,0.08);
  }
  .legend {
    background: rgba(255,255,255,0.95);
    padding: 12px 16px;
    border-radius: 12px;
    box-shadow: 0 6px 20px rgba(0,0,0,0.15);
    font-size: 14px;
    color: #333;
  }
  .legend h4 { margin-bottom: 10px; font-size: 15px; color: #0077cc; }
  .legend img { width: 25px; height: 41px; vertical-align: middle; margin-right: 8px; }
  #verification-info {
    max-width: 900px;
    margin: 20px auto 60px auto;
    font-size: 14px;
    text-align: center;
    color: #555;
  }
  #verification-info a { color: #0077cc; text-decoration: none; font-weight: 500; }
  #verification-info a:hover { text-decoration: underline; }
  @media (max-width:600px){#map{height:400px;}}
</style>
</head>
<body>
<header>
<h1>Interactive Map of Solar Recycling Sites</h1>
<nav><a href="index.html">← Back to Home</a></nav>
</header>

<main>
  <div id="map" aria-label="Map showing solar recycling sites"></div>
  <div id="verification-info">
    To suggest corrections or provide additional information, email 
    <a href="mailto:solarrecyclingnetwork@gmail.com">solarrecyclingnetwork@gmail.com</a>.
  </div>
</main>

<script>
const map = L.map('map').setView([37.5, -95], 4); // default US center
const bounds = [];

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: '© OpenStreetMap contributors'
}).addTo(map);

// Standard Leaflet icons
const greenIcon = new L.Icon({
  iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png',
  shadowUrl: 'https://unpkg.com/leaflet@1.9.3/dist/images/marker-shadow.png',
  iconSize: [25,41],
  iconAnchor: [12,41],
  popupAnchor: [1,-34],
  shadowSize: [41,41]
});

const grayIcon = new L.Icon({
  iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-grey.png',
  shadowUrl: 'https://unpkg.com/leaflet@1.9.3/dist/images/marker-shadow.png',
  iconSize: [25,41],
  iconAnchor: [12,41],
  popupAnchor: [1,-34],
  shadowSize: [41,41]
});

// Embedded JSON data
const sites = [
  {
    "location": "Goodyear, AZ",
    "address": "215 N 143rd Ave, Ste. 110, Goodyear, AZ 85338",
    "lat": 33.4251,
    "lng": -112.3899,
    "facilityType": "ITAD & E‑Waste Facility",
    "website": "https://eridirect.com/",
    "dateLastChecked": "Jul 24, 2025",
    "processVerified": false
  },
  {
    "location": "Fresno, CA (Supercenter)",
    "address": "3243 S East Ave, Bldg 108, Fresno, CA 93725",
    "lat": 36.8505,
    "lng": -119.8089,
    "facilityType": "ITAD & E‑Waste Supercenter",
    "website": "https://eridirect.com/",
    "dateLastChecked": "Jul 24, 2025",
    "processVerified": false
  }
  
];

sites.forEach(site => {
  const marker = L.marker([site.lat, site.lng], {
    icon: site.processVerified ? greenIcon : grayIcon
  }).addTo(map);

  marker.bindPopup(`
    <b>${site.location}</b><br>
    ${site.address}<br>
    <strong>Facility Type:</strong> ${site.facilityType}<br>
    <strong>Status:</strong> ${site.processVerified ? "Verified" : "Process Not Verified"}<br>
    <a href="${site.website}" target="_blank" rel="noopener noreferrer">Website</a><br>
    <em>Last checked: ${site.dateLastChecked}</em>
  `);

  bounds.push([site.lat, site.lng]);
});

if(bounds.length>0){
  map.fitBounds(bounds, { padding: [50,50] });
}

// Legend
const legend = L.control({position:"bottomright"});
legend.onAdd = function(){
  const div = L.DomUtil.create("div","legend");
  div.innerHTML = `
    <h4>Legend</h4>
    <p><img src="https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png" alt="green"> Verified</p>
    <p><img src="https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-grey.png" alt="gray"> Process Not Verified</p>
  `;
  return div;
};
legend.addTo(map);
</script>

<script defer src="/_vercel/insights/script.js"></script>
</body>
</html>
